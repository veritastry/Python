支付步骤：
拿到接受到的数据（接受的course_id，coupon_id）还有默认的用户id



验证步骤：
获取金币，进行数据的验证
去结算中（验证）


价格策略验证
循环这个redis里面的数据，拿到数据
原价：
优惠之后的价钱（进行判断价格策略是否可用，等）



计算金额步骤：

课程优惠卷：
获取原价-优惠金额
满减卷

折扣卷

全品卷

得到实际支付




全局优惠卷：
实际支付：
满减卷

折扣卷

全品卷

金币抵扣



最后的到的是最后应该支付的金额
总金额 =  上面的金额  -金币抵扣


开启事务步骤：
基于事务来完成的：

当未成功的时候，可以回滚事件


完成上面的之后：
为当前的课程生成新的订单（订单详细表里面创建数据―）
为当前的课程生成新的订单
为当前的课程生成新的订单



金币：相对应的减少
优惠卷：  相对应的减少
状态更新


如果支付宝支付金额为0，便是订单状态，未支付
如果是支付宝支付了金额的话，表示订单状态：已经支付

当支付成功的时候，生成一个url（包含你提交的订单数据）
回调函数（更新的订单状态）
如果没有支付成功的话，就会一直发送消息，未支付